# Learn my self | node project handling and express

## set-up recap

1. í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ ë‚´ë¶€ì— `npm init` ì»¤ë§¨ë“œë¥¼ ì…ë ¥í•œë‹¤.

2. `package.json`ì„ ì™„ì„±ì‹œí‚¨ë‹¤.  
   _package.jsì€ textë¡œ ì´ë£¨ì–´ì§„ í”„ë¡œì íŠ¸ì˜ ì •ë³´ë¥¼ ì œê³µí•˜ëŠ” ë¬¸ì„œì¼ ë¿ì´ë‹ˆ ì™„ë²½í•˜ê²Œ ì‘ì„±í•˜ì§€ ì•Šë”ë¼ë„ ì¶”í›„ì— ìˆ˜ì •ì„ í†µí•˜ì—¬ ì™„ì„±ì‹œí‚¤ë©´ ëœë‹¤. ìì£¼ ìˆ˜ì •í•˜ê²Œ ë˜ë‹ˆ ê°•ë°•ì„ ê°–ì§€ ì•Šì•„ë„ ëœë‹¤._
3. express, babel ë“± í•„ìš”í•œ dependenciesë¥¼ `npm i`ë¥¼ í™œìš©í•˜ì—¬ ì¶”ê°€í•œë‹¤. ì´ë•Œ, package.jsonì„ ì‘ì—…ì°½ì—ì„œ ë‹«ì€ ë’¤ ì¶”ê°€í•˜ëŠ” ê²ƒì„ ì¶”ì²œí•˜ê³  node\*modulsì´ë¼ëŠ” ë””ë ‰í† ë¦¬ê°€ ìë™ìœ¼ë¡œ ì¶”ê°€ë˜ë©´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ ëœ ê²ƒì´ë‹¤.  
   _`node_modules`ì˜ ì´ë¦„ìœ¼ë¡œ ëœ ë””ë ‰í† ë¦¬ëŠ” ê³µìœ í•  í•„ìš”ê°€ ì—†ë‹¤. package.jsonì— ê¸°ë¡ëœ ì •ë³´ë“¤ì„ í†µí•˜ì—¬ npmìœ¼ë¡œ í•œë²ˆì— í•„ìš”í•œ íŒ¨í‚¤ì§€ë“¤ì˜ ë²„ì „ê¹Œì§€ ë§ì¶° í•œë²ˆì— ì¶”ê°€ê°€ ê°€ëŠ¥í•˜ë‹¤_

> ğŸ’¡ í”„ë¡œì íŠ¸ë¥¼ í¸í•˜ê²Œ í•´ì£¼ëŠ” devDependencies : [babel install nodeJS](https://babeljs.io/setup#installation) ES6ë¥¼ ì»´íŒŒì¼ ì‹œì¼œì£¼ëŠ” ì—­í• , [nodemon](https://babeljs.io/setup#installation) íŒŒì¼ì €ì¥ ì‹œ ìë™ìœ¼ë¡œ npm run ì»¤ë§¨ë“œë¥¼ ì¬ì…ë ¥í•´ ì£¼ëŠ” ì—­í• 

---

## server recap

**nodeJS**ì—ì„œ **express**ë¥¼ ì‚¬ìš©í•˜ì—¬ ì„œë²„ë¥¼ ë§Œë“¤ ì‹œ ê°„ëµí•œ ì„¸íŒ… ë°©ë²•ì— ëŒ€í•˜ì—¬ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

### ì„œë²„ ë¦¬ìŠ¤ë‹ ê¸°ëŠ¥

1. ìš°ì„  ì„œë²„ì˜ ì—­í• ì„ í•´ì¤„ js íŒŒì¼ì„ ìƒì„±í•©ë‹ˆë‹¤.

2. ì´í›„ íŒŒì¼ ë‚´ë¶€ì— expressë¥¼ import í•©ë‹ˆë‹¤.

3. ì‚¬ìš©ë  ë³€ìˆ˜ë¥¼ ìƒì„±í•˜ê³  ë°”ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë„ë¡ ë¦¬í„´ì‹œí‚µë‹ˆë‹¤.

```jsx
import express from "express";

const app = express();
```

4. ë¦¬ìŠ¤ë‹ í•¨ìˆ˜ë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤.

```jsx
import express from "express";

const app = express();

const listeningMyServer = () => console.log("Listening on port 4000");

app.listen(4000, listeningMyServer);
```

ìœ„ ì½”ë“œë¥¼ í„°ë¯¸ë„ì„ í†µí•´ ì‹¤í–‰ì‹œì¼œ ë´…ë‹ˆë‹¤.

```
$ npm run #{npm_run_script}
```

ë¡œê·¸ ê¸°ë¡ì€ ì•„ë˜ì™€ ê°™ì´ ì¶œë ¥ë˜ì–´ì•¼ ì •ìƒì ìœ¼ë¡œ ì‘ë™í•˜ëŠ” ê²ƒì…ë‹ˆë‹¤.

```log
Listening on port 4000
```

ìœ„ì™€ ê°™ì´ ì‘ë™ ì¤‘ì´ë¼ë©´ ì„œë²„ê°€ ë™ì‘í•˜ê³  ìˆìœ¼ë©° ë™ì‹œì— ë¦¬ìŠ¤ë‹ ê¸°ëŠ¥ ë˜í•œ ì‘ë™ì¤‘ì¸ ê²ƒìœ¼ë¡œ í™•ì¸ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

---

### ê¸°ë³¸ì ì¸ route ì‘ì„±ë²•

expressë¥¼ í†µí•´ ì„œë²„ì™€ í†µì‹ í•˜ëŠ” ê°€ì¥ ë³´í¸ì ì¸ ë°©ë²•ì€ `get` apië¥¼ ì´ìš©í•˜ì—¬ í†µì‹ ì„ í•˜ëŠ” ë°©ë²•ì´ ìˆë‹¤.  
ìš”ì•½í•˜ìë©´ íŠ¹ì • urlì„ ë¸Œë¼ìš°ì € ì£¼ì†Œì°½ì— ì…ë ¥ ì‹œ **ë¸Œë¼ìš°ì €**ê°€ **ì„œë²„**ì— reqë¥¼ ë³´ë‚´ê³  **ì„œë²„**ê°€ **ë¸Œë¼ìš°ì €**ì— ìš”ì²­í•œ ë‚´ìš©ì„ ë³´ë‚´ëŠ” ë°©ì‹ì´ë‹¤.

`get`ì„ ë°›ì€ ë’¤ ë“¤ì–´ê°ˆ ì¸ìì— ì„¸ë¶€ì ì¸ ë‚´ìš©ë§Œ ë„£ì–´ì£¼ë©´ ë˜ëŠ” ê°„ë‹¨í•œ ë°©ë²•ì´ë‹¤.

`app.get($route)` ì—ì„œëŠ” `path`ê°€ í•„ìš”í•˜ë‹¤.  
pathë¡œëŠ” urlì´ í•„ìš”í•œê²ƒ ì´í›„ì—” ë§ì€ í•¸ë“¤ëŸ¬(í•¨ìˆ˜)ê°€ ë“¤ì–´ê°ˆ ìˆ˜ ìˆë‹¤.

ì•„ë˜ì˜ ì˜ˆì‹œì²˜ëŸ¼ ê°„ë‹¨í•œ routeë¥¼ ì‘ì„±í•´ë³¼ ìˆ˜ ìˆë‹¤.

```jsx
import express from "express";

const PORT = 4000;

const app = express();

const handleHome = () => console.log("Here is Home!");

app.get("/", handleHome);

const handleListening = () =>
  console.log(`âœ… Server listeting on port ${PORT}`);

app.listen(PORT, handleListening);
```

ë¡œê·¸ê¸°ë¡

```log
Here is Home!
```

ìœ„ì²˜ëŸ¼ ë¡œê·¸ ê¸°ë¡ìœ¼ë¡œëŠ” ëœ¨ì§€ë§Œ ì‹¤ì œ ë¸Œë¼ìš°ì €ì—ì„œëŠ” resë¥¼ ë°›ê³  ìˆì§€ ì•Šì•„ ì—ëŸ¬ë¥¼ ë„ìš°ê³  ì§€ì†ì ìœ¼ë¡œ ë¡œë”© ì¤‘ì¼ ê²ƒì´ë‹¤.

---

### ê¸°ë³¸ì ì¸ controller ì‘ì„±ë²•

route ì‘ì„±ì—ì„œ ì•Œê²Œë˜ì—ˆë“¯ ëª¨ë“  ë¼ìš°íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ í•¸ë“¤ëŸ¬ë¥¼ ê°€ì§€ê²Œ ë˜ê³  í•¸ë“¤ëŸ¬ë¥¼ í†µí•´ ë¸Œë¼ìš°ì €ê°€ ì„œë²„ì— `req`ë¥¼ ë³´ëƒˆê¸° ë•Œë¬¸ì— resë¥¼ ì£¼ì§€ ì•ŠëŠ”ë‹¤ë©´ ì´ì „ ë‚´ìš©ì²˜ëŸ¼ ì§€ì†ì ìœ¼ë¡œ ë¡œë”©ì„ í•  ê²ƒì´ë‹¤.

ë¼ìš°íŠ¸ ì‘ì„± ì‹œ ê°€ì§€ê²Œ ëœ í•¸ë“¤ëŸ¬ëŠ” controllerê°€ ë˜ë©° ì»¨íŠ¸ë¡¤ëŸ¬ì—ëŠ” `req`ì™€ `res` ì¸ìë¥¼ ê°–ê²Œ ëœë‹¤.  
ì¸ìì˜ ì´ë¦„ì¸ `req`ì™€ `res`ëŠ” ì¤‘ìš”í•˜ì§€ ì•Šê³  ìˆœì„œê°€ ì¤‘ìš”í•˜ë‹¤.  
ê° ì¸ìë§ˆë‹¤ ì—¬ëŸ¬ ë©”ì†Œë“œê°€ ì¡´ì¬í•˜ëŠ”ë° ì—¬ê¸°ì„œëŠ” ê¸°ë³¸ì ì¸ `res.end()`ì™€ `res.send()`ë§Œ ì§šê³  ë„˜ì–´ ê°ˆ ì˜ˆì •ì´ë‹¤.

- `res.end()`ëŠ” ì•„ë¬´ ì‘ë‹µ ì—†ì´ ê·¸ì € ì—°ê²°ì„ ì¢…ë£Œ ì‹œí‚¬ ë¿ì´ë‹¤.
- `res.send()`ëŠ” fn ì•ˆì˜ ë‚´ìš©ì„ ë³´ë‚´ì£¼ëŠ” ì‘ë‹µì„ ì£¼ëŠ” ê²ƒì´ë‹¤.
  \*htmlë¡œë„ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.

reqë¥¼ ì„œë²„ë¡œ ë³´ëƒˆë‹¤ë©´ ë°˜ë“œì‹œ res ë°›ì•„ì¤˜ì•¼í•œë‹¤. ê°„ë‹¨í•˜ê²Œ í‘œí˜„í•˜ìë©´

> routesë¥¼ ë§Œë“¤ê³  controllersë¥¼ ë§Œë“¤ì–´ ì„œë²„ì™€ ê¸°ë³¸ì ìœ¼ë¡œ í†µì‹ í•˜ê²Œ ë§Œë“œëŠ” ê²ƒì´ë‹¤.

ê°€ì¥ ì‰½ê²Œ ë³¼ ìˆ˜ ìˆëŠ” ì—ëŸ¬ë¡œëŠ” ë¼ìš°íŠ¸ ì»¨íŠ¸ë¡¤ëŸ¬ì— í•¨ìˆ˜ë¥¼ ì…ë ¥í•˜ì§€ ì•Šì•„ ë°œìƒí•˜ëŠ” ì—ëŸ¬ê°€ ì¦ê²Œ ë°œìƒ í•  ìˆ˜ ìˆë‹¤. ë°˜ë“œì‹œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ìˆì–´ì•¼ í•  ìë¦¬ì—ëŠ” í•¨ìˆ˜ë¥¼ ì…ë ¥í•´ì£¼ì–´ì•¼ í•œë‹¤. `get`ì€ **ë°˜ë“œì‹œ** í•¨ìˆ˜ê°€ í•„ìš”í•˜ë‹¤.

---

### middleware

middlewareëŠ” reqì™€ resì˜ ì¤‘ê°„ë‹¤ë¦¬ ì—­í• ì„ í•´ì£¼ëŠ” ì†Œí”„íŠ¸ì›¨ì–´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤. ë¼ìš°íŠ¸ ì‘ì„±ì‹œ url ë‹¤ìŒ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ë¶™ê²Œ ë˜ëŠ”ë° ì‚¬ì‹¤ ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ë„ ë¯¸ë“¤ì›¨ì–´ê°€ ë  ìˆ˜ ìˆë‹¤. ê°€ì¥ ì¤‘ìš”í•œ í•µì‹¬ì€ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸ì ì¤‘ `next()`í•¨ìˆ˜ê°€ ë¶™ëŠ”ë‹¤ëŠ” ì ì´ë‹¤.

ì•„ë˜ì˜ ì˜ˆì‹œ ì½”ë“œë¥¼ ì°¸ê³ í•´ë³´ì.

```jsx
// middlerware
const logger = (req, res, next) => {
  console.log("here is logger middleware!");
  next();
};

// controller
const home = (req, res) => {
  res.send("Hello world!");
};

app.get("/", logger, home);
```

ë¼ìš°íŠ¸ë¥¼ ë³´ë©´ url ë’¤ë¡œ `logger`ë¼ëŠ” í•¸ë“¤ëŸ¬ê°€ í•˜ë‚˜ ë” ë¶™ê²Œ ë˜ì—ˆë‹¤. ìœ„ ì½”ë“œì—ì„œ ë³´ì´ë“¯ ë¼ìš°íŠ¸ì—ì„œ ë¡œê±°ë¡œ ìš°ì„  í•¨ìˆ˜ë¥¼ ì‹¤í–‰ ì‹œí‚¨ ë’¤ ì‘ë‹µì„ í•˜ê³  ê·¸ ë’¤ë¡œ í™ˆì´ë¼ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ê°€ ì‹¤í–‰ë˜ì–´ ë¡œê·¸ì°½ì—ëŠ” `here is logger middleware!`ê°€ í‘œê¸°ë˜ê³  `Hello world!`ë¼ëŠ” ë¬¸êµ¬ëŠ” ë¸Œë¼ìš°ì €ì— í”„ë¦°íŠ¸í•˜ê²Œ ëœë‹¤.

ë¯¸ë“¤ì›¨ì–´ëŠ” ì–´ë– í•œ ì»¨íŠ¸ë¡¤ëŸ¬ê°€ resë¥¼ í†µì‹ ì„ í•˜ê¸° ì „ê¹Œì§€ ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë¯¸ë“¤ì›¨ì–´ë¼ê³  ì¹­í•  ìˆ˜ ìˆë‹¤. ê·¸ëŸ¬í•œ ê´€ë¡€ë¡œ ëª¨ë“  ë§ˆì§€ë§‰ ì»¨íŠ¸ë¡¤ëŸ¬ ì¸ìì—ëŠ” `next` í•¨ìˆ˜ë¥¼ í¬í•¨ì‹œí‚¤ì§€ ì•ŠëŠ”ë‹¤.

ë¯¸ë“¤ì›¨ì–´ë¥¼ í•˜ë‚˜ì˜ ë¼ìš°íŠ¸ì—ë§Œ ì‚¬ìš© í•  ìˆ˜ë„ ìˆì§€ë§Œ `app.use()`ë¥¼ í™œìš©í•˜ì—¬ ëª¨ë“  ì»¨íŠ¸ë¡¤ëŸ¬ ì´ì „ì— ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‘ë™ ì‹œí‚¬ ìˆ˜ë„ ìˆë‹¤.

```jsx
// middlerware
const logger = (req, res, next) => {
  console.log("here is logger middleware!");
  next();
};

// controller
const home = (req, res) => {
  res.send("Hello world!");
};

app.use(logger);
app.get("/", home);
```

ìœ„ì™€ ê°™ì´ ì‹¤í–‰í•´ë„ ì´ì „ê³¼ ê°™ì€ ê²°ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆë‹¤. `app.use`ëŠ” ëª¨ë“  routeì—ì„œ ì‚¬ìš©ë˜ëŠ” middlewareë¥¼ ì ìš©ì‹œí‚¬ ìˆ˜ ìˆë‹¤.

`use`ë¥¼ í™œìš©í•˜ì—¬ ë¯¸ë“¤ì›¨ì–´ë¥¼ ê¸€ë¡œë²Œí•˜ê²Œ ì‘ë™ì‹œí‚¬ë ¤ë©´ ë°˜ë“œì‹œ ì ìš©ë  ë¼ìš°íŠ¸ ìœ— ë¼ì¸ì— ì…ë ¥ë˜ì–´ìˆì–´ì•¼í•œë‹¤.

> ğŸ’¡ expressëŠ” ëª¨ë“  ê±¸ ìœ„ì—ì„œ ì•„ë˜ ìˆœìœ¼ë¡œ ì‹¤í–‰ì‹œí‚¨ë‹¤. javascriptì™€ ê°™ì€ ì›ë¦¬ì´ê¸° ë•Œë¬¸ì´ë‹¤.

---

### morgan

ë¯¸ë“¤ì›¨ì–´ë¥¼ ì§ì ‘ ë§Œë“¤ ìˆ˜ë„ ìˆì§€ë§Œ npmì„ ë³´ë©´ ìœ ìš©í•œ ë¯¸ë“¤ì›¨ì–´ë„ ì¡´ì¬í•œë‹¤.

[morgan](https://www.npmjs.com/package/morgan)ì€ ì¶”ê°€ì ì¸ ë¡œê·¸ ê¸°ë¡ì„ ì‰½ê²Œ ë³¼ ìˆ˜ ìˆëŠ” íŒ¨í‚¤ì§€ì´ë‹¤. ê°„ë‹¨í•˜ê²Œ morganì„ ì ìš©ì‹œì¼œë³´ì.

```shell
$ npm i morgan
```

```jsx
import morgan from "morgan";

// ê°œë°œí™˜ê²½ ì‹œ dev
const logger = morgan("dev");

app.use(logger);
```

```shell
GET / 304 3.545 ms - -
```

ìœ„ì™€ ê°™ì´ ì ìš©ë  ìˆ˜ ìˆë‹¤.

ì´ì™¸ì—ë„ ë”ìš± ì •êµí•œ ë¡œê·¸ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.  
ìœ„ì˜ ì˜ˆì‹œì˜ devë¥¼ ì´ìš©í•œ ë¡œê·¸ í™•ì¸ì€  
**method, path, status code, ì‘ë‹µì‹œê°„** ìˆœìœ¼ë¡œ ì•Œë ¤ì¤€ë‹¤.

ì´ì™¸ì—ëŠ”

- combined
  - ì‹œê°„
  - method
  - http version
  - status code
  - ì‚¬ìš© ì¤‘ì¸ ë¸Œë¼ìš°ì €
  - OS ì •ë³´
  - ë“±ë“±
- common
  - ì‹œê°„
  - method
  - path
  - http version
  - status code
- short
  - method
  - path
  - http version
  - status code
  - ì‘ë‹µì‹œê°„
- tiny
  - method
  - path
  - status code
  - ì‘ë‹µì‹œê°„

ìœ„ì™€ ê°™ì´ í™•ì¸ í•  ìˆ˜ ìˆìœ¼ë‹ˆ í•„ìš”ì— ë§ê²Œ ì‚¬ìš© í•  ìˆ˜ ìˆë‹¤.
